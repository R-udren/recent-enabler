# Recent & SysMain Manager

**CLI утилита для проверки и управления записью недавних файлов (Recent) и службой SysMain в Windows.**

## 🎯 Возможности

### 📁 Recent (Недавние файлы)

- ✅ Проверка статуса записи недавних файлов
- ✅ Просмотр количества файлов и размера папки Recent
- ✅ Включение записи недавних файлов через реестр
- ✅ Определение пустоты папки

### ⚙️ SysMain (SuperFetch)

- ✅ Проверка статуса службы SysMain
- ✅ Просмотр типа запуска (автоматический/ручной/отключен)
- ✅ Подсчет файлов в папке Prefetch
- ✅ Включение службы и изменение типа запуска

## 🚀 Установка и запуск

### Требования

- Windows 10/11
- Rust (для сборки из исходников)

### Сборка

```bash
cargo build --release
```

### Запуск

#### CLI режим (рекомендуется)

```bash
# Показать справку
recent-enabler --help

# Проверить статус Recent
recent-enabler check-recent

# Проверить статус SysMain
recent-enabler check-sysmain

# Показать полный статус
recent-enabler status

# Включить Recent
recent-enabler enable-recent

# Включить SysMain (требуются права администратора)
recent-enabler enable-sysmain
```

#### Интерактивный режим

Запустите без аргументов для интерактивного меню:

```bash
recent-enabler
```

#### Запуск с правами администратора

Для полного функционала используйте:

```bash
run_as_admin.bat
```

## 📋 Использование

### CLI команды

```
Usage: recent-enabler.exe [COMMAND]

Commands:
  check-recent    Проверить статус папки Recent
  check-sysmain   Проверить статус службы SysMain
  enable-recent   Включить запись в Recent
  enable-sysmain  Включить службу SysMain
  status          Показать статус всего
  help            Print this message or the help of the given subcommand(s)

Options:
  -h, --help     Print help
  -V, --version  Print version
```

### Интерактивное меню

```
╔════════════════════════════════════════════════╗
║    Recent & SysMain Manager v0.1.0 (CLI)     ║
╚════════════════════════════════════════════════╝

  1. 📁 Проверить статус Recent
  2. ⚙️  Проверить статус SysMain
  3. 📊 Показать статус всего
  4. ✅ Включить Recent
  5. ✅ Включить SysMain
  0. ❌ Выход

Выберите действие (0-5):
```

## 🔍 Что проверяется

### Recent

1. **Путь к папке**: `%APPDATA%\Microsoft\Windows\Recent`
2. **Статус записи**: Проверка ключа реестра `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoRecentDocsHistory`
3. **Содержимое**: Количество файлов .lnk и общий размер папки

### SysMain

1. **Служба**: Статус службы SysMain (запущена/остановлена)
2. **Тип запуска**: Автоматический/Ручной/Отключен
3. **Prefetch**: Количество файлов в `%SystemRoot%\Prefetch`

## 📊 Примеры вывода

### Проверка Recent

```
╔══════════════════════════════════════════╗
║          📁 Статус Recent               ║
╚══════════════════════════════════════════╝

  Путь: C:\Users\User\AppData\Roaming\Microsoft\Windows\Recent
  Запись: ✓ Включена
  Папка: ✓ Содержит файлы
  Количество файлов: 83
  Размер папки: 42.42 KB
```

### Проверка SysMain

```
╔══════════════════════════════════════════╗
║         ⚙️  Статус SysMain               ║
╚══════════════════════════════════════════╝

  Статус службы: ✓ Запущена
  Тип запуска: ✓ Автоматический
  Папка Prefetch: C:\Windows\Prefetch
  Файлов .pf: 1234
```

## ⚠️ Важно

- Некоторые функции требуют **прав администратора**:

  - Включение службы SysMain
  - Изменение типа запуска службы
  - Доступ к папке Prefetch

- Программа работает **только на Windows**

## 🏗️ Архитектура

Проект организован по модульному принципу:

```
src/
├── main.rs      # Точка входа, CLI, интерактивное меню
├── recent.rs    # Логика работы с Recent
├── sysmain.rs   # Логика работы с SysMain
└── utils.rs     # Вспомогательные функции
```

### Библиотеки

- **clap** - современный CLI парсер с derive API
- **windows** - официальная библиотека Windows API
- **anyhow** - удобная обработка ошибок

## 📝 Лицензия

MIT

## 👤 Автор

Создано с использованием лучших практик Rust и чистых функций.
